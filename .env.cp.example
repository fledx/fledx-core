# fledx Control Plane Configuration
# Copy this file to .env.cp and adjust the values for your environment

# Server Settings
FLEDX_CP_SERVER_HOST=0.0.0.0
FLEDX_CP_SERVER_PORT=49421

# Metrics (Prometheus)
FLEDX_CP_METRICS_HOST=0.0.0.0
FLEDX_CP_METRICS_PORT=49422

# Database
# Use absolute path for production: sqlite:///var/lib/fledx/fledx-cp.db
FLEDX_CP_DATABASE_URL=sqlite://./data/fledx-cp.db

# Tunnel Settings
FLEDX_CP_TUNNEL_ADVERTISED_HOST=127.0.0.1
FLEDX_CP_TUNNEL_ADVERTISED_PORT=49423
FLEDX_CP_TUNNEL_USE_TLS=false
FLEDX_CP_TUNNEL_HEARTBEAT_INTERVAL_SECS=30
FLEDX_CP_TUNNEL_HEARTBEAT_TIMEOUT_SECS=90

# Authentication
# IMPORTANT: Change these tokens in production!
FLEDX_CP_REGISTRATION_TOKEN=change-me-registration-token-123
FLEDX_CP_OPERATOR_TOKENS=change-me-operator-token-123,another-operator-token-456
FLEDX_CP_OPERATOR_HEADER_NAME=authorization
FLEDX_CP_TOKENS_PEPPER=change-me-pepper-secret-xyz

# Resource Limits
FLEDX_CP_LIMITS_REGISTRATION_BODY_BYTES=16384
FLEDX_CP_LIMITS_HEARTBEAT_BODY_BYTES=65536
FLEDX_CP_LIMITS_CONFIG_PAYLOAD_BYTES=131072

# Data Retention (in seconds)
FLEDX_CP_RETENTION_INSTANCE_STATUS_SECS=86400         # 24 hours
FLEDX_CP_RETENTION_INSTANCE_METRICS_SECS=600          # 10 minutes
FLEDX_CP_RETENTION_USAGE_WINDOW_SECS=604800           # 7 days
FLEDX_CP_RETENTION_USAGE_CLEANUP_INTERVAL_SECS=300    # 5 minutes

# Node Reachability
FLEDX_CP_REACHABILITY_HEARTBEAT_STALE_SECS=90
FLEDX_CP_REACHABILITY_SWEEP_INTERVAL_SECS=15
FLEDX_CP_REACHABILITY_RESCHEDULE_ON_UNREACHABLE=true

# Port Management
FLEDX_CP_PORTS_AUTO_ASSIGN=false
FLEDX_CP_PORTS_RANGE_START=30000
FLEDX_CP_PORTS_RANGE_END=40000

# Volume Security
# Array of allowed host path prefixes
# Note: For environment variables, use indexed notation like below,
# or use a config.toml file with: volumes.allowed_host_prefixes = ["/path1", "/path2"]
FLEDX_CP_VOLUMES_ALLOWED_HOST_PREFIXES_0=/var/lib/fledx/volumes
FLEDX_CP_VOLUMES_ALLOWED_HOST_PREFIXES_1=/data

# Features
FLEDX_CP_FEATURES_ENFORCE_AGENT_COMPATIBILITY=true

# Logging
# Options: error, warn, info, debug, trace
RUST_LOG=info,fledx=debug

# Advanced Logging (uncomment for JSON output)
# RUST_LOG_FORMAT=json
