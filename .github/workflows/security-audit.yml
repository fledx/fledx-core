name: Security Audit

on:
  # Run weekly on Mondays at 9:00 UTC
  schedule:
    - cron: '0 9 * * 1'
  # Allow manual triggering
  workflow_dispatch:

permissions:
  contents: read

jobs:
  security-audit:
    name: Security Audit
    uses: ./.github/workflows/rust-job.yml
    with:
      cache_shared_key: security
      cache_bin: true
      command: |
        mkdir -p .cargo
        cp audit.toml .cargo/audit.toml
        cargo install --locked cargo-audit
        cargo audit
        cargo install --locked cargo-deny
        cargo deny check advisories
        cargo deny check licenses
        cargo deny check bans
        cargo deny check sources
