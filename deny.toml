# cargo-deny configuration for fledx-core
# Ensures all dependencies use BSL 1.1 compatible licenses

[graph]
all-features = false
no-default-features = false

[output]
feature-depth = 1

[advisories]
ignore = [
    # rustls-pemfile is unmaintained but still used by bollard 0.19.4
    # Will be resolved when bollard updates to rustls 0.23
    { id = "RUSTSEC-2025-0134", reason = "Transitive dependency via bollard, waiting for upstream update" },

    # paste unmaintained, used by ratatui
    { id = "RUSTSEC-2024-0436", reason = "Transitive dependency via ratatui" },
]

[licenses]
# Only permissive licenses compatible with BSL 1.1
# Copyleft licenses (GPL, AGPL, LGPL) are automatically denied
allow = [
    "MIT",
    "Apache-2.0",
    "Apache-2.0 WITH LLVM-exception",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "ISC",
    "CC0-1.0",
    "Zlib",
    "BSL-1.0",
    "Unicode-3.0",
    "OpenSSL",
    "CDLA-Permissive-2.0",
]

confidence-threshold = 0.8
exceptions = [
    { name = "cli", version = "*" , allow = ["BUSL-1.1"] },
    { name = "common", version = "*", allow = ["BUSL-1.1"] },
    { name = "control-plane", version = "*", allow = ["BUSL-1.1"] },
    { name = "node-agent", version = "*", allow = ["BUSL-1.1"] },
]

[licenses.private]
ignore = true

[bans]
multiple-versions = "allow"
wildcards = "allow"
highlight = "all"
workspace-default-features = "allow"
external-default-features = "allow"
allow = []
deny = []
skip = []
skip-tree = []

[sources]
unknown-registry = "warn"
unknown-git = "deny"
allow-registry = ["https://github.com/rust-lang/crates.io-index"]

[sources.allow-org]
github = []
gitlab = []
bitbucket = []
